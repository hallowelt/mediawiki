"use strict";var p=(o,n,d)=>new Promise((c,s)=>{var r=l=>{try{i(d.next(l))}catch(f){s(f)}},u=l=>{try{i(d.throw(l))}catch(f){s(f)}},i=l=>l.done?c(l.value):Promise.resolve(l.value).then(r,u);i((d=d.apply(o,n)).next())});const e=require("vue"),z=require("./CdxButton.cjs"),$=require("./Icon.js"),R=require("./useI18nWithOverride.js"),W=require("./useResizeObserver.cjs"),j=require("./_plugin-vue_export-helper.js"),K=e.defineComponent({name:"CdxDialog",components:{CdxButton:z,CdxIcon:$.CdxIcon},inheritAttrs:!1,props:{open:{type:Boolean,default:!1},title:{type:String,required:!0},subtitle:{type:String,required:!1,default:null},hideTitle:{type:Boolean,default:!1},useCloseButton:{type:Boolean,default:!1},closeButtonLabel:{type:String,default:"",validator:(o,n)=>o.length>0&&!n.useCloseButton?(console.warn("[CdxDialog]: The boolean `useCloseButton` prop is required to show the close button.\n\nRefer to https://doc.wikimedia.org/codex/latest/components/demos/dialog.html#props."),!1):!0},primaryAction:{type:Object,default:null},defaultAction:{type:Object,default:null},stackedActions:{type:Boolean,default:!1},target:{type:String,default:null},renderInPlace:{type:Boolean,default:!1}},emits:["update:open","primary","default"],setup(o,{emit:n}){const d=e.useId(),c=e.ref(),s=e.ref(),r=e.ref(),u=e.ref(),i=e.ref(),l=e.ref(),f=e.ref();let m=null;const v=e.computed(()=>o.useCloseButton||o.closeButtonLabel.length>0),N=R.useI18nWithOverride(e.toRef(o,"closeButtonLabel"),"cdx-dialog-close-button-label","Close"),V=e.computed(()=>!o.hideTitle||v.value),I=e.computed(()=>!!o.primaryAction||!!o.defaultAction),S=W(r),D=e.computed(()=>{var t;return(t=S.value.height)!=null?t:0}),k=e.ref(!1),H=e.computed(()=>({"cdx-dialog--vertical-actions":o.stackedActions,"cdx-dialog--horizontal-actions":!o.stackedActions,"cdx-dialog--dividers":k.value})),L=e.inject("CdxTeleportTarget",void 0),F=e.computed(()=>{var t,a;return(a=(t=o.target)!=null?t:e.unref(L))!=null?a:"body"});e.provide("CdxTeleportTarget",f);const C=e.ref(0);function B(){n("update:open",!1)}let w=!1;function q(t){w=t.target===c.value}function O(){w&&B()}function _(){g(s.value)}function x(){g(s.value,!0)}function g(t,a=!1){let h=Array.from(t.querySelectorAll('\n					input, select, textarea, button, object, a, area,\n					[contenteditable], [tabindex]:not([tabindex^="-"])\n				'));a&&(h=h.reverse());for(const T of h)if(T.focus(),document.activeElement===T)return!0;return!1}let b=[],y=[];function M(){let t=c.value;for(;t.parentElement&&t.nodeName!=="BODY";){for(const a of Array.from(t.parentElement.children))a===t||a.nodeName==="SCRIPT"||(a.hasAttribute("aria-hidden")||(a.setAttribute("aria-hidden","true"),b.push(a)),a.hasAttribute("inert")||(a.setAttribute("inert",""),y.push(a)));t=t.parentElement}}function P(){for(const t of b)t.removeAttribute("aria-hidden");for(const t of y)t.removeAttribute("inert");b=[],y=[]}function A(){return p(this,null,function*(){var t;yield e.nextTick(),C.value=window.innerWidth-document.documentElement.clientWidth,document.documentElement.style.setProperty("margin-right","".concat(C.value,"px")),document.body.classList.add("cdx-dialog-open"),M(),m=document.activeElement,g(r.value)||(t=u.value)==null||t.focus()})}function E(){document.body.classList.remove("cdx-dialog-open"),document.documentElement.style.removeProperty("margin-right"),P(),m instanceof HTMLElement&&document.contains(m)&&(m.focus(),m=null)}return e.onMounted(()=>p(null,null,function*(){o.open&&(yield A())})),e.onUnmounted(()=>{o.open&&E()}),e.watch(e.toRef(o,"open"),t=>p(null,null,function*(){t?yield A():E()})),e.watch(D,()=>{r.value&&(k.value=r.value.clientHeight<r.value.scrollHeight)}),{close:B,onBackdropClick:O,onBackdropMouseDown:q,cdxIconClose:$.e4,labelId:d,rootClasses:H,backdrop:c,dialogElement:s,focusTrapStart:i,focusTrapEnd:l,innerTeleportTarget:f,focusFirst:_,focusLast:x,dialogBody:r,focusHolder:u,showHeader:V,showFooterActions:I,useCloseButtonOrLabel:v,translatedCloseButtonLabel:N,computedTarget:F}}}),U=["aria-label","aria-labelledby"],Y={key:0,class:"cdx-dialog__header__title-group"},G=["id"],J={key:0,class:"cdx-dialog__header__subtitle"},Q={ref:"focusHolder",class:"cdx-dialog-focus-trap",tabindex:"-1"},X={key:0,class:"cdx-dialog__footer__text"},Z={key:1,class:"cdx-dialog__footer__actions"},ee={ref:"innerTeleportTarget"};function oe(o,n,d,c,s,r){const u=e.resolveComponent("cdx-icon"),i=e.resolveComponent("cdx-button");return e.openBlock(),e.createBlock(e.Teleport,{to:o.computedTarget,disabled:o.renderInPlace},[e.createVNode(e.Transition,{name:"cdx-dialog-fade",appear:""},{default:e.withCtx(()=>[o.open?(e.openBlock(),e.createElementBlock("div",{key:0,ref:"backdrop",class:"cdx-dialog-backdrop",onMousedown:n[5]||(n[5]=(...l)=>o.onBackdropMouseDown&&o.onBackdropMouseDown(...l)),onClick:n[6]||(n[6]=(...l)=>o.onBackdropClick&&o.onBackdropClick(...l)),onKeyup:n[7]||(n[7]=e.withKeys((...l)=>o.close&&o.close(...l),["escape"]))},[e.createElementVNode("div",{ref:"focusTrapStart",tabindex:"0",onFocus:n[0]||(n[0]=(...l)=>o.focusLast&&o.focusLast(...l))},null,544),e.createElementVNode("div",e.mergeProps({ref:"dialogElement",class:["cdx-dialog",o.rootClasses],role:"dialog"},o.$attrs,{"aria-label":o.$slots.header||o.hideTitle?o.title:void 0,"aria-labelledby":!o.$slots.header&&!o.hideTitle?o.labelId:void 0,"aria-modal":"true",onClick:n[3]||(n[3]=e.withModifiers(()=>{},["stop"]))}),[o.showHeader||o.$slots.header?(e.openBlock(),e.createElementBlock("header",{key:0,class:e.normalizeClass(["cdx-dialog__header",{"cdx-dialog__header--default":!o.$slots.header}])},[e.renderSlot(o.$slots,"header",{},()=>[o.hideTitle?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createElementBlock("div",Y,[e.createElementVNode("h2",{id:o.labelId,class:"cdx-dialog__header__title"},e.toDisplayString(o.title),9,G),o.subtitle?(e.openBlock(),e.createElementBlock("p",J,e.toDisplayString(o.subtitle),1)):e.createCommentVNode("v-if",!0)])),o.useCloseButtonOrLabel?(e.openBlock(),e.createBlock(i,{key:1,class:"cdx-dialog__header__close-button",weight:"quiet",type:"button","aria-label":o.translatedCloseButtonLabel,onClick:o.close},{default:e.withCtx(()=>[e.createVNode(u,{icon:o.cdxIconClose},null,8,["icon"])]),_:1},8,["aria-label","onClick"])):e.createCommentVNode("v-if",!0)])],2)):e.createCommentVNode("v-if",!0),e.createElementVNode("div",Q,null,512),e.createElementVNode("div",{ref:"dialogBody",class:e.normalizeClass(["cdx-dialog__body cdx-scrollable-container",{"cdx-dialog__body--no-header":!(o.showHeader||o.$slots.header),"cdx-dialog__body--no-footer":!(o.showFooterActions||o.$slots.footer||o.$slots["footer-text"])}])},[e.renderSlot(o.$slots,"default")],2),o.showFooterActions||o.$slots.footer||o.$slots["footer-text"]?(e.openBlock(),e.createElementBlock("footer",{key:1,class:e.normalizeClass(["cdx-dialog__footer",{"cdx-dialog__footer--default":!o.$slots.footer}])},[e.renderSlot(o.$slots,"footer",{},()=>[o.$slots["footer-text"]?(e.openBlock(),e.createElementBlock("p",X,[e.renderSlot(o.$slots,"footer-text")])):e.createCommentVNode("v-if",!0),o.showFooterActions?(e.openBlock(),e.createElementBlock("div",Z,[o.primaryAction?(e.openBlock(),e.createBlock(i,{key:0,class:"cdx-dialog__footer__primary-action",weight:"primary",action:o.primaryAction.actionType,disabled:o.primaryAction.disabled,onClick:n[1]||(n[1]=l=>o.$emit("primary"))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.primaryAction.label),1)]),_:1},8,["action","disabled"])):e.createCommentVNode("v-if",!0),o.defaultAction?(e.openBlock(),e.createBlock(i,{key:1,class:"cdx-dialog__footer__default-action",disabled:o.defaultAction.disabled,onClick:n[2]||(n[2]=l=>o.$emit("default"))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(o.defaultAction.label),1)]),_:1},8,["disabled"])):e.createCommentVNode("v-if",!0)])):e.createCommentVNode("v-if",!0)])],2)):e.createCommentVNode("v-if",!0)],16,U),e.createElementVNode("div",{ref:"focusTrapEnd",tabindex:"0",onFocus:n[4]||(n[4]=(...l)=>o.focusFirst&&o.focusFirst(...l))},null,544),e.createElementVNode("div",ee,null,512)],544)):e.createCommentVNode("v-if",!0)]),_:3})],8,["to","disabled"])}const te=j._export_sfc(K,[["render",oe]]);module.exports=te;
