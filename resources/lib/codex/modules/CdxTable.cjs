"use strict";const e=require("vue"),h=require("./constants.js"),V=require("./useModelWrapper.cjs"),E=require("./CdxCheckbox.cjs"),p=require("./Icon.js"),R=require("./_plugin-vue_export-helper.js"),N=h.makeStringTypeValidator(h.TableTextAlignments),$={none:p.T7,asc:p.x8,desc:p.l4},A={none:"none",asc:"ascending",desc:"descending"},T=e.defineComponent({name:"CdxTable",components:{CdxCheckbox:E,CdxIcon:p.CdxIcon},props:{caption:{type:String,required:!0},hideCaption:{type:Boolean,default:!1},columns:{type:Array,default:()=>[],validator:t=>{const a=t.map(c=>c.id);return new Set(a).size===a.length?!0:(console.warn('Each column in the "columns" prop of CdxTable must have a unique "id".'),!1)}},data:{type:Array,default:()=>[],validator:(t,a)=>{if(!Array.isArray(a.columns)||a.columns.length===0||t.length===0)return!0;const i=a.columns.some(d=>"allowSort"in d),c=t.every(d=>h.TableRowIdentifier in d);return i&&a.useRowSelection&&!c?(console.warn('For CdxTables with sorting and row selection, each row in the "data" prop must have a "TableRowIdentifier".'),!1):!0}},useRowHeaders:{type:Boolean,default:!1},showVerticalBorders:{type:Boolean,default:!1},useRowSelection:{type:Boolean,default:!1},selectedRows:{type:Array,default:()=>[]},selectAllLabel:{type:String,default:"Select all rows"},selectRowLabel:{type:Function,default:(t,a)=>"Select row ".concat(t," of ").concat(a)},sort:{type:Object,default:()=>({})},sortCaption:{type:String,default:", column headers with buttons are sortable."}},emits:["update:selectedRows","update:sort"],setup(t,{emit:a}){const i=V(e.toRef(t,"selectedRows"),a,"update:selectedRows"),c=e.ref(t.data.length===i.value.length),d=e.ref(!1),g=e.computed(()=>Object.keys(t.sort)[0]),f=e.computed(()=>t.columns.some(o=>o.allowSort)),b=e.computed(()=>{var n;return{"cdx-table__table--layout-fixed":(n=t.columns)==null?void 0:n.some(r=>"width"in r||"minWidth"in r),"cdx-table__table--borders-vertical":t.showVerticalBorders}});function l(o,n){return h.TableRowIdentifier in o?o[h.TableRowIdentifier]:n}function u(o,n){const r=l(o,n);return{"cdx-table__row--selected":i.value.indexOf(r)!==-1}}function s(o){const n=t.columns[0].id;if(t.useRowHeaders===!0&&o===n)return"row"}function y(o){const n=t.columns[0].id;return t.useRowHeaders&&o===n?"th":"td"}function k(o,n=!1){if("textAlign"in o&&!N(o.textAlign)){console.warn("Invalid value for TableColumn textAlign property.");return}return{["cdx-table__table__cell--align-".concat(o.textAlign)]:"textAlign"in o&&o.textAlign!=="start","cdx-table__table__cell--has-sort":n}}function S(o){const n={};return"width"in o&&(n.width=o.width),"minWidth"in o&&(n.minWidth=o.minWidth),n}function C(o){if(t.data.length===o.length){c.value=!0,d.value=!1;return}c.value=!1,t.data.length>o.length&&(d.value=!0),o.length===0&&(d.value=!1)}function w(o){d.value=!1,o?i.value=t.data.map((n,r)=>l(n,r)):i.value=[]}function _(o){var m;const n=(m=t.sort[o])!=null?m:"none";let r="asc";n==="asc"&&(r="desc"),n==="desc"&&(r="none"),a("update:sort",{[o]:r})}function v(o){var r;const n=(r=t.sort[o])!=null?r:"none";return $[n]}function B(o,n=!1){var r;if(n){const m=(r=t.sort[o])!=null?r:"none";return m==="none"?void 0:A[m]}}return{wrappedSelectedRows:i,selectAll:c,selectAllIndeterminate:d,activeSortColumn:g,hasSortableColumns:f,tableClasses:b,getRowKey:l,getRowClass:u,getRowHeaderScope:s,getCellElement:y,getCellClass:k,getCellStyle:S,handleRowSelection:C,handleSelectAll:w,handleSort:_,getSortIcon:v,getSortOrder:B}}}),I={class:"cdx-table",tabindex:"0"},q={key:0,class:"cdx-table__header"},D=["aria-hidden"],F={class:"cdx-table__header__content"},L={class:"cdx-table__table-wrapper"},O={key:0},z={key:0},H={key:0,class:"cdx-table__table__select-rows"},U=["aria-sort"],x=["aria-selected","onClick"],W={key:0},K={key:0},M={key:1},j={class:"cdx-table__table__empty-state"},G={class:"cdx-table__table__empty-state-content"},J={key:1,class:"cdx-table__footer"};function P(t,a,i,c,d,g){const f=e.resolveComponent("cdx-checkbox"),b=e.resolveComponent("cdx-icon");return e.openBlock(),e.createElementBlock("div",I,[!t.hideCaption||t.$slots.header&&t.$slots.header().length>0?(e.openBlock(),e.createElementBlock("div",q,[e.createElementVNode("div",{class:"cdx-table__header__caption","aria-hidden":t.$slots.header&&t.$slots.header().length>0?void 0:!0},[t.hideCaption?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.caption),1)],64))],8,D),e.createElementVNode("div",F,[e.renderSlot(t.$slots,"header")])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",L,[e.createElementVNode("table",{class:e.normalizeClass(["cdx-table__table",t.tableClasses])},[e.createElementVNode("caption",null,[e.createTextVNode(e.toDisplayString(t.caption)+" ",1),t.hasSortableColumns?(e.openBlock(),e.createElementBlock("span",O,e.toDisplayString(t.sortCaption),1)):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"thead",{},()=>[t.columns.length>0?(e.openBlock(),e.createElementBlock("thead",z,[e.createElementVNode("tr",null,[t.useRowSelection?(e.openBlock(),e.createElementBlock("th",H,[e.createVNode(f,{modelValue:t.selectAll,"onUpdate:modelValue":[a[0]||(a[0]=l=>t.selectAll=l),t.handleSelectAll],"hide-label":!0,indeterminate:t.selectAllIndeterminate},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectAllLabel),1)]),_:1},8,["modelValue","indeterminate","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,l=>(e.openBlock(),e.createElementBlock("th",{key:l.id,scope:"col",class:e.normalizeClass(t.getCellClass(l,l.allowSort)),"aria-sort":t.getSortOrder(l.id,l.allowSort),style:e.normalizeStyle(t.getCellStyle(l))},[l.allowSort?(e.openBlock(),e.createElementBlock("button",{key:0,"aria-selected":l.id===t.activeSortColumn,class:"cdx-table__table__sort-button",onClick:u=>t.handleSort(l.id)},[e.createTextVNode(e.toDisplayString(l.label)+" ",1),e.createVNode(b,{icon:t.getSortIcon(l.id),size:"small",class:"cdx-table__table__sort-icon","aria-hidden":"true"},null,8,["icon"])],8,x)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(l.label),1)],64))],14,U))),128))])])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tbody",{},()=>[t.data.length>0?(e.openBlock(),e.createElementBlock("tbody",W,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data,(l,u)=>(e.openBlock(),e.createElementBlock("tr",{key:t.getRowKey(l,u),class:e.normalizeClass(t.getRowClass(l,u))},[t.useRowSelection?(e.openBlock(),e.createElementBlock("td",K,[e.createVNode(f,{modelValue:t.wrappedSelectedRows,"onUpdate:modelValue":[a[1]||(a[1]=s=>t.wrappedSelectedRows=s),t.handleRowSelection],"input-value":t.getRowKey(l,u),"hide-label":!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectRowLabel(u+1,t.data.length)),1)]),_:2},1032,["modelValue","input-value","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,s=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.getCellElement(s.id)),{key:s.id,scope:t.getRowHeaderScope(s.id),class:e.normalizeClass(t.getCellClass(s))},{default:e.withCtx(()=>[e.renderSlot(t.$slots,"item-"+s.id,{item:l[s.id],row:l},()=>[e.createTextVNode(e.toDisplayString(l[s.id]),1)])]),_:2},1032,["scope","class"]))),128))],2))),128))])):t.$slots["empty-state"]&&t.$slots["empty-state"]().length>0?(e.openBlock(),e.createElementBlock("tbody",M,[e.createElementVNode("tr",j,[e.createElementVNode("td",G,[e.renderSlot(t.$slots,"empty-state")])])])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tfoot")],2)]),t.$slots.footer&&t.$slots.footer().length>0?(e.openBlock(),e.createElementBlock("div",J,[e.renderSlot(t.$slots,"footer")])):e.createCommentVNode("v-if",!0)])}const Q=R._export_sfc(T,[["render",P]]);module.exports=Q;
