"use strict";const e=require("vue"),h=require("./constants.js"),R=require("./useModelWrapper.cjs"),E=require("./CdxCheckbox.cjs"),b=require("./Icon.js"),N=require("./_plugin-vue_export-helper.js"),A=h.makeStringTypeValidator(h.TableTextAlignments),T={none:b.q7,asc:b.g8,desc:b.l4},$={none:"none",asc:"ascending",desc:"descending"},q=e.defineComponent({name:"CdxTable",components:{CdxCheckbox:E,CdxIcon:b.CdxIcon},props:{caption:{type:String,required:!0},hideCaption:{type:Boolean,default:!1},columns:{type:Array,default:()=>[],validator:t=>{const r=t.map(c=>c.id);return new Set(r).size===r.length||console.warn("Each column in the `columns` prop of CdxTable must have a unique `id`."),!0}},data:{type:Array,default:()=>[]},useRowHeaders:{type:Boolean,default:!1},showVerticalBorders:{type:Boolean,default:!1},useRowSelection:{type:Boolean,default:!1},selectedRows:{type:Array,default:()=>[]},selectAllLabel:{type:String,default:"Select all rows"},selectRowLabel:{type:Function,default:(t,r)=>"Select row ".concat(t," of ").concat(r)},sort:{type:Object,default:()=>({})},sortCaption:{type:String,default:", column headers with buttons are sortable."}},emits:["update:selectedRows","update:sort"],setup(t,{emit:r}){const d=R(e.toRef(t,"selectedRows"),r,"update:selectedRows"),c=e.ref(t.data.length===d.value.length),u=e.ref(!1),S=e.computed(()=>Object.keys(t.sort)[0]),m=e.computed(()=>t.columns.some(o=>o.allowSort)),p=e.computed(()=>{var l;return{"cdx-table__table--layout-fixed":(l=t.columns)==null?void 0:l.some(a=>"width"in a||"minWidth"in a),"cdx-table__table--borders-vertical":t.showVerticalBorders}});function n(o,l){return h.TableRowIdentifier in o?o[h.TableRowIdentifier]:l}function i(o,l){const a=n(o,l);return{"cdx-table__row--selected":d.value.indexOf(a)!==-1}}function s(o){const l=t.columns[0].id;if(t.useRowHeaders===!0&&o===l)return"row"}function y(o){const l=t.columns[0].id;return t.useRowHeaders&&o===l?"th":"td"}function C(o,l=!1){if("textAlign"in o&&!A(o.textAlign)){console.warn("Invalid value for TableColumn textAlign property.");return}return{["cdx-table__table__cell--align-".concat(o.textAlign)]:"textAlign"in o&&o.textAlign!=="start","cdx-table__table__cell--has-sort":l}}function k(o){const l={};return"width"in o&&(l.width=o.width),"minWidth"in o&&(l.minWidth=o.minWidth),l}function w(o){if(t.data.length===o.length){c.value=!0,u.value=!1;return}c.value=!1,t.data.length>o.length&&(u.value=!0),o.length===0&&(u.value=!1)}function v(o){u.value=!1,o?d.value=t.data.map((l,a)=>n(l,a)):d.value=[]}function B(o){var f;const l=(f=t.sort[o])!=null?f:"none";let a="asc";l==="asc"&&(a="desc"),l==="desc"&&(a="none"),r("update:sort",{[o]:a})}function V(o){var a;const l=(a=t.sort[o])!=null?a:"none";return T[l]}function _(o,l=!1){var a;if(l){const f=(a=t.sort[o])!=null?a:"none";return f==="none"?void 0:$[f]}}function g(){if(t.columns.length===0||t.data.length===0)return;const o=t.columns.some(a=>"allowSort"in a),l=t.data.every(a=>h.TableRowIdentifier in a);o&&t.useRowSelection&&!l&&console.warn("For CdxTables with sorting and row selection, each row in the `data` prop must have a `TableRowIdentifier`.")}return e.onMounted(()=>g()),e.watch(e.toRef(t,"columns"),()=>g()),e.watch(e.toRef(t,"data"),()=>g()),e.watch(e.toRef(t,"useRowSelection"),()=>g()),{wrappedSelectedRows:d,selectAll:c,selectAllIndeterminate:u,activeSortColumn:S,hasSortableColumns:m,tableClasses:p,getRowKey:n,getRowClass:i,getRowHeaderScope:s,getCellElement:y,getCellClass:C,getCellStyle:k,handleRowSelection:w,handleSelectAll:v,handleSort:B,getSortIcon:V,getSortOrder:_}}}),D={class:"cdx-table",tabindex:"0"},I={key:0,class:"cdx-table__header"},F=["aria-hidden"],L={class:"cdx-table__header__content"},O={class:"cdx-table__table-wrapper"},z={key:0},H={key:0},U={key:0,class:"cdx-table__table__select-rows"},x=["aria-sort"],W=["aria-selected","onClick"],K={key:0},M={key:0},j={key:1,class:"cdx-table__footer"};function G(t,r,d,c,u,S){const m=e.resolveComponent("cdx-checkbox"),p=e.resolveComponent("cdx-icon");return e.openBlock(),e.createElementBlock("div",D,[!t.hideCaption||t.$slots.header&&t.$slots.header().length>0?(e.openBlock(),e.createElementBlock("div",I,[e.createElementVNode("div",{class:"cdx-table__header__caption","aria-hidden":t.$slots.header&&t.$slots.header().length>0?void 0:!0},[t.hideCaption?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.caption),1)],64))],8,F),e.createElementVNode("div",L,[e.renderSlot(t.$slots,"header")])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",O,[e.createElementVNode("table",{class:e.normalizeClass(["cdx-table__table",t.tableClasses])},[e.createElementVNode("caption",null,[e.createTextVNode(e.toDisplayString(t.caption)+" ",1),t.hasSortableColumns?(e.openBlock(),e.createElementBlock("span",z,e.toDisplayString(t.sortCaption),1)):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"thead",{},()=>[t.columns.length>0?(e.openBlock(),e.createElementBlock("thead",H,[e.createElementVNode("tr",null,[t.useRowSelection?(e.openBlock(),e.createElementBlock("th",U,[e.createVNode(m,{modelValue:t.selectAll,"onUpdate:modelValue":[r[0]||(r[0]=n=>t.selectAll=n),t.handleSelectAll],"hide-label":!0,indeterminate:t.selectAllIndeterminate},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectAllLabel),1)]),_:1},8,["modelValue","indeterminate","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,n=>(e.openBlock(),e.createElementBlock("th",{key:n.id,scope:"col",class:e.normalizeClass(t.getCellClass(n,n.allowSort)),"aria-sort":t.getSortOrder(n.id,n.allowSort),style:e.normalizeStyle(t.getCellStyle(n))},[n.allowSort?(e.openBlock(),e.createElementBlock("button",{key:0,"aria-selected":n.id===t.activeSortColumn,class:"cdx-table__table__sort-button",onClick:i=>t.handleSort(n.id)},[e.createTextVNode(e.toDisplayString(n.label)+" ",1),e.createVNode(p,{icon:t.getSortIcon(n.id),size:"small",class:"cdx-table__table__sort-icon","aria-hidden":"true"},null,8,["icon"])],8,W)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(n.label),1)],64))],14,x))),128))])])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tbody",{},()=>[t.data.length>0?(e.openBlock(),e.createElementBlock("tbody",K,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data,(n,i)=>(e.openBlock(),e.createElementBlock("tr",{key:t.getRowKey(n,i),class:e.normalizeClass(t.getRowClass(n,i))},[t.useRowSelection?(e.openBlock(),e.createElementBlock("td",M,[e.createVNode(m,{modelValue:t.wrappedSelectedRows,"onUpdate:modelValue":[r[1]||(r[1]=s=>t.wrappedSelectedRows=s),t.handleRowSelection],"input-value":t.getRowKey(n,i),"hide-label":!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectRowLabel(i+1,t.data.length)),1)]),_:2},1032,["modelValue","input-value","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,s=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.getCellElement(s.id)),{key:s.id,scope:t.getRowHeaderScope(s.id),class:e.normalizeClass(t.getCellClass(s))},{default:e.withCtx(()=>[e.renderSlot(t.$slots,"item-"+s.id,{item:n[s.id],row:n},()=>[e.createTextVNode(e.toDisplayString(n[s.id]),1)])]),_:2},1032,["scope","class"]))),128))],2))),128))])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tfoot")],2)]),t.$slots.footer&&t.$slots.footer().length>0?(e.openBlock(),e.createElementBlock("div",j,[e.renderSlot(t.$slots,"footer")])):e.createCommentVNode("v-if",!0)])}const J=N._export_sfc(q,[["render",G]]);module.exports=J;
