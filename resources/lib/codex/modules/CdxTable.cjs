"use strict";const e=require("vue"),h=require("./constants.js"),q=require("./useModelWrapper.cjs"),T=require("./CdxCheckbox.cjs"),g=require("./Icon.js"),A=require("./_plugin-vue_export-helper.js");require("./CdxLabel.cjs");require("./useFieldData.cjs");require("./useComputedDisabled.cjs");require("./useSplitAttributes.cjs");require("./useLabelChecker.js");require("./useSlotContents.js");require("./useWarnOnce.cjs");require("./useGeneratedId.cjs");require("./useComputedDirection.cjs");require("./useComputedLanguage.cjs");const $=h.makeStringTypeValidator(h.TableTextAlignments),I={none:g.q7,asc:g.g8,desc:g.l4},y={none:"none",asc:"ascending",desc:"descending"},L=e.defineComponent({name:"CdxTable",components:{CdxCheckbox:T,CdxIcon:g.CdxIcon},props:{caption:{type:String,required:!0},hideCaption:{type:Boolean,default:!1},columns:{type:Array,default:()=>[],validator:t=>{const s=t.map(d=>d.id);return new Set(s).size===s.length||console.warn("Each column in the `columns` prop of CdxTable must have a unique `id`."),!0}},data:{type:Array,default:()=>[]},useRowHeaders:{type:Boolean,default:!1},showVerticalBorders:{type:Boolean,default:!1},useRowSelection:{type:Boolean,default:!1},selectedRows:{type:Array,default:()=>[]},selectAllLabel:{type:String,default:"Select all rows"},selectRowLabel:{type:String,default:"Select row"},sort:{type:Object,default:()=>({})},sortCaption:{type:String,default:", column headers with buttons are sortable."}},emits:["update:selectedRows","update:sort"],setup(t,{emit:s}){const i=q(e.toRef(t,"selectedRows"),s,"update:selectedRows"),d=e.ref(t.data.length===i.value.length),u=e.ref(!1),p=e.computed(()=>Object.keys(t.sort)[0]),m=e.computed(()=>t.columns.some(o=>o.allowSort)),S=e.computed(()=>{var l;return{"cdx-table__table--layout-fixed":(l=t.columns)==null?void 0:l.some(a=>"width"in a||"minWidth"in a),"cdx-table__table--borders-vertical":t.showVerticalBorders}});function n(o,l){return h.TableRowIdentifier in o?o[h.TableRowIdentifier]:l}function f(o,l){const a=n(o,l);return{"cdx-table__row--selected":i.value.indexOf(a)!==-1}}function r(o){const l=t.columns[0].id;if(t.useRowHeaders===!0&&o===l)return"row"}function C(o){const l=t.columns[0].id;return t.useRowHeaders&&o===l?"th":"td"}function k(o,l=!1){if("textAlign"in o&&!$(o.textAlign)){console.warn("Invalid value for TableColumn textAlign property.");return}return{["cdx-table__table__cell--align-".concat(o.textAlign)]:"textAlign"in o&&o.textAlign!=="start","cdx-table__table__cell--has-sort":l}}function v(o){const l={};return"width"in o&&(l.width=o.width),"minWidth"in o&&(l.minWidth=o.minWidth),l}function _(o){if(t.data.length===o.length){d.value=!0,u.value=!1;return}d.value===!0&&(u.value=!0,d.value=!1),o.length===0&&(u.value=!1)}function B(o){u.value=!1,o?i.value=t.data.map((l,a)=>n(l,a)):i.value=[]}function V(o){var c;const l=(c=t.sort[o])!=null?c:"none";let a="asc";l==="asc"&&(a="desc"),l==="desc"&&(a="none"),s("update:sort",{[o]:a})}function R(o){var a;const l=(a=t.sort[o])!=null?a:"none";return I[l]}function E(o){var c,w;const l=(c=t.sort[o.id])!=null?c:"none",a=(w=o==null?void 0:o.label)!=null?w:o.id;if(l!=="none")return"Sort rows by ".concat(a.toLowerCase()," in ").concat(y[l]," order.")}function N(o,l=!1){var a;if(l){const c=(a=t.sort[o])!=null?a:"none";return y[c]}}function b(){if(t.columns.length===0||t.data.length===0)return;const o=t.columns.some(a=>"allowSort"in a),l=t.data.every(a=>h.TableRowIdentifier in a);o&&t.useRowSelection&&!l&&console.warn("For CdxTables with sorting and row selection, each row in the `data` prop must have a `TableRowIdentifier`.")}return e.onMounted(()=>b()),e.watch(e.toRef(t,"columns"),()=>b()),e.watch(e.toRef(t,"data"),()=>b()),e.watch(e.toRef(t,"useRowSelection"),()=>b()),{wrappedSelectedRows:i,selectAll:d,selectAllIndeterminate:u,activeSortColumn:p,hasSortableColumns:m,tableClasses:S,getRowKey:n,getRowClass:f,getRowHeaderScope:r,getCellElement:C,getCellClass:k,getCellStyle:v,handleRowSelection:_,handleSelectAll:B,handleSort:V,getSortIcon:R,getSortIconLabel:E,getSortOrder:N}}});const O={class:"cdx-table",tabindex:"0"},D={key:0,class:"cdx-table__header"},F=["aria-hidden"],x={class:"cdx-table__header__content"},z={class:"cdx-table__table-wrapper"},H={key:0},U={key:0},W={key:0,class:"cdx-table__table__select-rows"},K=["aria-sort"],M=["aria-selected","onClick"],j={key:0},G={key:0},J={key:1,class:"cdx-table__footer"};function P(t,s,i,d,u,p){const m=e.resolveComponent("cdx-checkbox"),S=e.resolveComponent("cdx-icon");return e.openBlock(),e.createElementBlock("div",O,[!t.hideCaption||t.$slots.header&&t.$slots.header().length>0?(e.openBlock(),e.createElementBlock("div",D,[e.createElementVNode("div",{class:"cdx-table__header__caption","aria-hidden":t.$slots.header&&t.$slots.header().length>0?void 0:!0},[t.hideCaption?e.createCommentVNode("v-if",!0):(e.openBlock(),e.createElementBlock(e.Fragment,{key:0},[e.createTextVNode(e.toDisplayString(t.caption),1)],64))],8,F),e.createElementVNode("div",x,[e.renderSlot(t.$slots,"header")])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",z,[e.createElementVNode("table",{class:e.normalizeClass(["cdx-table__table",t.tableClasses])},[e.createElementVNode("caption",null,[e.createTextVNode(e.toDisplayString(t.caption)+" ",1),t.hasSortableColumns?(e.openBlock(),e.createElementBlock("span",H,e.toDisplayString(t.sortCaption),1)):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"thead",{},()=>[t.columns.length>0?(e.openBlock(),e.createElementBlock("thead",U,[e.createElementVNode("tr",null,[t.useRowSelection?(e.openBlock(),e.createElementBlock("th",W,[e.createVNode(m,{modelValue:t.selectAll,"onUpdate:modelValue":[s[0]||(s[0]=n=>t.selectAll=n),t.handleSelectAll],"hide-label":!0,indeterminate:t.selectAllIndeterminate},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectAllLabel),1)]),_:1},8,["modelValue","indeterminate","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,n=>(e.openBlock(),e.createElementBlock("th",{key:n.id,scope:"col",class:e.normalizeClass(t.getCellClass(n,n.allowSort)),"aria-sort":t.getSortOrder(n.id,n.allowSort),style:e.normalizeStyle(t.getCellStyle(n))},[n.allowSort?(e.openBlock(),e.createElementBlock("button",{key:0,"aria-selected":n.id===t.activeSortColumn,class:"cdx-table__table__sort-button",onClick:f=>t.handleSort(n.id)},[e.createTextVNode(e.toDisplayString(n.label)+" ",1),e.createVNode(S,{icon:t.getSortIcon(n.id),size:"small",class:"cdx-table__table__sort-icon","aria-label":t.getSortIconLabel(n),"aria-hidden":"true"},null,8,["icon","aria-label"])],8,M)):(e.openBlock(),e.createElementBlock(e.Fragment,{key:1},[e.createTextVNode(e.toDisplayString(n.label),1)],64))],14,K))),128))])])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tbody",{},()=>[t.data.length>0?(e.openBlock(),e.createElementBlock("tbody",j,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.data,(n,f)=>(e.openBlock(),e.createElementBlock("tr",{key:t.getRowKey(n,f),class:e.normalizeClass(t.getRowClass(n,f))},[t.useRowSelection?(e.openBlock(),e.createElementBlock("td",G,[e.createVNode(m,{modelValue:t.wrappedSelectedRows,"onUpdate:modelValue":[s[1]||(s[1]=r=>t.wrappedSelectedRows=r),t.handleRowSelection],"input-value":t.getRowKey(n,f),"hide-label":!0},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.selectRowLabel),1)]),_:2},1032,["modelValue","input-value","onUpdate:modelValue"])])):e.createCommentVNode("v-if",!0),(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.columns,r=>(e.openBlock(),e.createBlock(e.resolveDynamicComponent(t.getCellElement(r.id)),{key:r.id,scope:t.getRowHeaderScope(r.id),class:e.normalizeClass(t.getCellClass(r))},{default:e.withCtx(()=>[e.renderSlot(t.$slots,"item-"+r.id,{item:n[r.id],row:n},()=>[e.createTextVNode(e.toDisplayString(n[r.id]),1)])]),_:2},1032,["scope","class"]))),128))],2))),128))])):e.createCommentVNode("v-if",!0)]),e.renderSlot(t.$slots,"tfoot")],2)]),t.$slots.footer&&t.$slots.footer().length>0?(e.openBlock(),e.createElementBlock("div",J,[e.renderSlot(t.$slots,"footer")])):e.createCommentVNode("v-if",!0)])}const Q=A._export_sfc(L,[["render",P]]);module.exports=Q;
