"use strict";var b=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,K=Object.prototype.propertyIsEnumerable;var y=(e,n)=>{var a={};for(var o in e)E.call(e,o)&&n.indexOf(o)<0&&(a[o]=e[o]);if(e!=null&&b)for(var o of b(e))n.indexOf(o)<0&&K.call(e,o)&&(a[o]=e[o]);return a};const t=require("vue"),g=require("./Icon.js"),w=require("./CdxMenu.js"),C=require("./useGeneratedId.js"),F=require("./useModelWrapper.js"),W=require("./useFieldData.js"),H=require("./useSplitAttributes.js"),j=require("./useFloatingMenu.js"),p=require("./constants.js"),z=require("./_plugin-vue_export-helper.js");require("./CdxMenuItem.js");require("./CdxThumbnail.js");require("./CdxSearchResultTitle.js");require("./CdxProgressBar.js");require("./useWarnOnce.js");require("./useIntersectionObserver.js");const G=p.makeStringTypeValidator(p.ValidationStatusTypes),R=t.defineComponent({name:"CdxSelect",components:{CdxIcon:g.CdxIcon,CdxMenu:w},inheritAttrs:!1,props:{menuItems:{type:Array,required:!0},selected:{type:[String,Number,null],required:!0},defaultLabel:{type:String,default:""},disabled:{type:Boolean,default:!1},menuConfig:{type:Object,default:()=>({})},defaultIcon:{type:[String,Object],default:void 0},status:{type:String,default:"default",validator:G}},emits:["update:selected","load-more"],setup(e,{emit:n,attrs:a}){const o=t.ref(),i=t.ref(),v=t.inject(p.FieldDescriptionIdKey,void 0),m=C.useGeneratedId("select-menu"),u=t.ref(!1),l=a.id||C.useGeneratedId("select-handle"),{computedDisabled:c,computedStatus:q,computedInputId:S}=W.useFieldData(t.toRef(e,"disabled"),t.toRef(e,"status"),l),h=F.useModelWrapper(t.toRef(e,"selected"),n,"update:selected"),r=t.computed(()=>e.menuItems.find(d=>d.value===e.selected)),x=t.computed(()=>{var d;return r.value?(d=r.value.label)!=null?d:r.value.value:e.defaultLabel}),f=t.computed(()=>{var d;if(e.defaultIcon&&!r.value)return e.defaultIcon;if((d=r.value)!=null&&d.icon)return r.value.icon}),M=t.computed(()=>({"cdx-select-vue--enabled":!c.value,"cdx-select-vue--disabled":c.value,"cdx-select-vue--expanded":u.value,"cdx-select-vue--value-selected":!!r.value,"cdx-select-vue--no-selections":!r.value,"cdx-select-vue--has-start-icon":!!f.value,["cdx-select-vue--status-".concat(q.value)]:!0})),{rootClasses:k,rootStyle:B,otherAttrs:V}=H.useSplitAttributes(a,M),$=t.computed(()=>{const I=V.value,{id:d}=I;return y(I,["id"])}),N=t.computed(()=>{var d,s;return(s=(d=i.value)==null?void 0:d.getHighlightedMenuItem())==null?void 0:s.id});function A(){u.value=!1}function L(){var d;c.value||(u.value=!u.value,(d=o.value)==null||d.focus())}function D(d){var s;c.value||(s=i.value)==null||s.delegateKeyNavigation(d,{characterNavigation:!0})}return j.useFloatingMenu(o,i),{handle:o,menu:i,computedHandleId:S,descriptionId:v,menuId:m,modelWrapper:h,selectedMenuItem:r,highlightedId:N,expanded:u,computedDisabled:c,onBlur:A,currentLabel:x,rootClasses:k,rootStyle:B,otherAttrsMinusId:$,onClick:L,onKeydown:D,startIcon:f,cdxIconExpand:g.z3}}});const T=["aria-disabled"],O=["id","aria-controls","aria-activedescendant","aria-expanded","aria-describedby"];function P(e,n,a,o,i,v){const m=t.resolveComponent("cdx-icon"),u=t.resolveComponent("cdx-menu");return t.openBlock(),t.createElementBlock("div",{class:t.normalizeClass(["cdx-select-vue",e.rootClasses]),style:t.normalizeStyle(e.rootStyle),"aria-disabled":e.computedDisabled},[t.createElementVNode("div",t.mergeProps({id:e.computedHandleId,ref:"handle",class:"cdx-select-vue__handle"},e.otherAttrsMinusId,{tabindex:"0",role:"combobox","aria-controls":e.menuId,"aria-activedescendant":e.highlightedId,"aria-expanded":e.expanded,"aria-describedby":e.descriptionId,onClick:n[0]||(n[0]=(...l)=>e.onClick&&e.onClick(...l)),onBlur:n[1]||(n[1]=(...l)=>e.onBlur&&e.onBlur(...l)),onKeydown:n[2]||(n[2]=(...l)=>e.onKeydown&&e.onKeydown(...l))}),[t.renderSlot(e.$slots,"label",{selectedMenuItem:e.selectedMenuItem,defaultLabel:e.defaultLabel},()=>[t.createTextVNode(t.toDisplayString(e.currentLabel),1)]),e.startIcon?(t.openBlock(),t.createBlock(m,{key:0,icon:e.startIcon,class:"cdx-select-vue__start-icon"},null,8,["icon"])):t.createCommentVNode("",!0),t.createVNode(m,{icon:e.cdxIconExpand,class:"cdx-select-vue__indicator"},null,8,["icon"])],16,O),t.createVNode(u,t.mergeProps({id:e.menuId,ref:"menu",selected:e.modelWrapper,"onUpdate:selected":n[3]||(n[3]=l=>e.modelWrapper=l),expanded:e.expanded,"onUpdate:expanded":n[4]||(n[4]=l=>e.expanded=l),"menu-items":e.menuItems},e.menuConfig,{onLoadMore:n[5]||(n[5]=l=>e.$emit("load-more"))}),{default:t.withCtx(({menuItem:l})=>[t.renderSlot(e.$slots,"menu-item",{menuItem:l})]),_:3},16,["id","selected","expanded","menu-items"])],14,T)}const U=z._export_sfc(R,[["render",P]]);module.exports=U;
