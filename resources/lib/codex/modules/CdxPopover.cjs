"use strict";var _=(t,a,d)=>new Promise((l,u)=>{var m=n=>{try{r(d.next(n))}catch(f){u(f)}},p=n=>{try{r(d.throw(n))}catch(f){u(f)}},r=n=>n.done?l(n.value):Promise.resolve(n.value).then(m,p);r((d=d.apply(t,a)).next())});const e=require("vue"),C=require("./unwrapElement.js"),b=require("./Icon.js"),I=require("./CdxButton.cjs"),H=require("./useI18nWithOverride.js"),M=require("./constants.js"),h=require("./floating-ui.dom.js"),j=require("./_plugin-vue_export-helper.js"),R=e.defineComponent({name:"CdxPopover",components:{CdxButton:I,CdxIcon:b.CdxIcon},inheritAttrs:!1,props:{anchor:{type:Object,default:null},open:{type:Boolean,default:!1},title:{type:String,default:""},icon:{type:[String,Object],default:""},useCloseButton:{type:Boolean,default:!1},closeButtonLabel:{type:String,default:"Close"},primaryAction:{type:Object,default:null},defaultAction:{type:Object,default:null},stackedActions:{type:Boolean,default:!1},renderInPlace:{type:Boolean,default:!1},placement:{type:String,default:"bottom"}},emits:["update:open","primary","default"],setup(t,{emit:a}){const d=e.toRef(t,"placement"),l=e.ref(),u=e.toRef(t,"anchor"),m=e.ref(),p=16,r=192,n=200,f=512,B=Math.sqrt(16**2+16**2)/2+4,E=e.computed(()=>[h.offset(B),h.flip(),h.size({padding:p,apply({availableWidth:o,availableHeight:i,elements:y}){const P=Math.min(f,o);Object.assign(y.floating.style,{maxWidth:"".concat(Math.max(r,P),"px"),maxHeight:"".concat(Math.max(n,i),"px")})}}),C.arrow({element:m})]),{floatingStyles:x,middlewareData:w,placement:A,x:$,y:S}=C.useFloating(u,l,{whileElementsMounted:h.autoUpdate,placement:d,middleware:E}),c=e.reactive({left:"0",top:"0",right:"0",bottom:"0",transform:"none"}),k=e.computed(()=>M.oppositeSides[A.value]);e.watch([$,S],()=>{if(w.value.arrow){const{x:o,y:i}=w.value.arrow;c.left=o?"".concat(o,"px"):"",c.top=i?"".concat(i,"px"):"",c.right="",c.bottom="",c[k.value]="".concat(-16/2-1,"px");const y={top:"rotate( 45deg )",right:"rotate( 135deg )",bottom:"rotate( 225deg )",left:"rotate( 315deg )"};c.transform=y[k.value]}});const L=e.inject("CdxTeleportTarget",void 0),V=e.computed(()=>{var o;return(o=e.unref(L))!=null?o:"body"}),N=H.useI18nWithOverride(e.toRef(t,"closeButtonLabel"),"cdx-popover-close-button-label","Close"),T=e.computed(()=>!!t.title||!!t.icon||t.useCloseButton),O=e.computed(()=>!!t.primaryAction||!!t.defaultAction),q=e.computed(()=>({"cdx-popover__footer__actions--vertical":t.stackedActions,"cdx-popover__footer__actions--horizontal":!t.stackedActions}));function g(){a("update:open",!1)}function v(o){o.key==="Escape"&&g()}function s(o){const i=C.unwrapElement(u.value);o.target!==document.documentElement&&l.value&&!l.value.contains(o.target)&&!(i!=null&&i.contains(o.target))&&g()}return e.watch(()=>t.open,o=>{o?(document.addEventListener("keydown",v),document.addEventListener("mousedown",s),document.addEventListener("focusin",s)):(document.removeEventListener("keydown",v),document.removeEventListener("mousedown",s),document.removeEventListener("focusin",s))}),e.onMounted(()=>_(null,null,function*(){t.open&&(document.addEventListener("keydown",v),document.addEventListener("mousedown",s),document.addEventListener("focusin",s)),yield e.nextTick(),t.anchor===null&&console.warn('[CdxPopover]: The "anchor" prop must be provided to position the CdxPopover.')})),e.onUnmounted(()=>{document.removeEventListener("keydown",v),document.removeEventListener("mousedown",s),document.removeEventListener("focusin",s)}),{computedTarget:V,translatedCloseButtonLabel:N,showHeader:T,showFooter:O,footerActionsClasses:q,close:g,cdxIconClose:b.v4,floating:l,floatingStyles:x,arrowRef:m,arrowStyles:c}}}),W={key:0,class:"cdx-popover__header"},D={key:1,class:"cdx-popover__header__title"},z={class:"cdx-popover__header__button-wrapper"},F={class:"cdx-popover__body"},U={key:1,class:"cdx-popover__footer"};function K(t,a,d,l,u,m){const p=e.resolveComponent("cdx-icon"),r=e.resolveComponent("cdx-button");return e.openBlock(),e.createBlock(e.Teleport,{to:t.computedTarget,disabled:t.renderInPlace},[t.open?(e.openBlock(),e.createElementBlock("div",e.mergeProps({key:0,ref:"floating",class:"cdx-popover",style:t.floatingStyles},t.$attrs),[t.showHeader||t.$slots.header?(e.openBlock(),e.createElementBlock("header",W,[e.renderSlot(t.$slots,"header",{},()=>[t.icon?(e.openBlock(),e.createBlock(p,{key:0,class:"cdx-popover__header__icon",icon:t.icon},null,8,["icon"])):e.createCommentVNode("v-if",!0),t.title?(e.openBlock(),e.createElementBlock("div",D,e.toDisplayString(t.title),1)):e.createCommentVNode("v-if",!0),e.createElementVNode("div",z,[t.useCloseButton?(e.openBlock(),e.createBlock(r,{key:0,class:"cdx-popover__header__close-button",weight:"quiet",type:"button","aria-label":t.translatedCloseButtonLabel,onClick:t.close},{default:e.withCtx(()=>[e.createVNode(p,{icon:t.cdxIconClose},null,8,["icon"])]),_:1},8,["aria-label","onClick"])):e.createCommentVNode("v-if",!0)])])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",F,[e.renderSlot(t.$slots,"default")]),t.showFooter||t.$slots.footer?(e.openBlock(),e.createElementBlock("footer",U,[e.renderSlot(t.$slots,"footer",{},()=>[e.createElementVNode("div",{class:e.normalizeClass(["cdx-popover__footer__actions",t.footerActionsClasses])},[t.primaryAction?(e.openBlock(),e.createBlock(r,{key:0,class:"cdx-popover__footer__primary-action",weight:"primary",action:t.primaryAction.actionType,disabled:t.primaryAction.disabled,onClick:a[0]||(a[0]=n=>t.$emit("primary"))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.primaryAction.label),1)]),_:1},8,["action","disabled"])):e.createCommentVNode("v-if",!0),t.defaultAction?(e.openBlock(),e.createBlock(r,{key:1,class:"cdx-popover__footer__default-action",disabled:t.defaultAction.disabled,onClick:a[1]||(a[1]=n=>t.$emit("default"))},{default:e.withCtx(()=>[e.createTextVNode(e.toDisplayString(t.defaultAction.label),1)]),_:1},8,["disabled"])):e.createCommentVNode("v-if",!0)],2)])])):e.createCommentVNode("v-if",!0),e.createElementVNode("div",{ref:"arrowRef",class:"cdx-popover__arrow",style:e.normalizeStyle(t.arrowStyles)},null,4)],16)):e.createCommentVNode("v-if",!0)],8,["to","disabled"])}const X=j._export_sfc(R,[["render",K]]);module.exports=X;
