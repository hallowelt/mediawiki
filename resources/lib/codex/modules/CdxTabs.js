"use strict";const e=require("vue"),x=require("./Icon.js"),A=require("./CdxButton.js"),M=require("./CdxTab.js"),$=require("./useGeneratedId.js"),R=require("./useComputedDirection.js"),W=require("./useModelWrapper.js"),L=require("./useIntersectionObserver.js"),D=require("./useSlotContents2.js"),K=require("./constants.js"),O=require("./_plugin-vue_export-helper.js");require("./useComputedLanguage.js");require("./useIconOnlyButton.js");require("./useWarnOnce.js");const F=e.defineComponent({name:"CdxTabs",components:{CdxButton:A,CdxIcon:x.CdxIcon},props:{active:{type:String,required:!0},framed:{type:Boolean,default:!1}},emits:["update:active"],expose:["select","next","prev"],setup(t,{slots:s,emit:c}){const b=e.ref(),i=e.ref(),p=e.ref(),d=e.ref(),v=R(b),a=e.computed(()=>{const o=D.useSlotContents(s.default);if(!o.every(n=>typeof n=="object"&&D.isComponentVNode(n,M.name)))throw new Error("Slot content may only contain CdxTab components");if(o.length===0)throw new Error("Slot content cannot be empty");return o}),f=e.computed(()=>a.value.reduce((o,n)=>{var l;if((l=n.props)!=null&&l.name&&typeof n.props.name=="string"){if(o.get(n.props.name))throw new Error("Tab names must be unique");o.set(n.props.name,{name:n.props.name,id:$(n.props.name),label:n.props.label||n.props.name,disabled:n.props.disabled})}return o},new Map)),r=W(e.toRef(t,"active"),c,"update:active"),m=e.computed(()=>Array.from(f.value.keys())),T=e.computed(()=>m.value.indexOf(r.value)),w=e.computed(()=>{var o;return(o=f.value.get(r.value))==null?void 0:o.id});e.provide(K.ActiveTabKey,r),e.provide(K.TabsKey,f);const g=e.ref(new Map),C=e.ref(),E=e.ref(),S=L(C,{threshold:.95}),I=L(E,{threshold:.95});function V(o,n){const l=o;l&&(g.value.set(n,l),n===0?C.value=l:n===m.value.length-1&&(E.value=l))}const B=e.computed(()=>({"cdx-tabs--framed":t.framed,"cdx-tabs--quiet":!t.framed}));function _(){var o;(o=g.value.get(T.value))==null||o.focus()}function y(o){if(!i.value||!p.value||!d.value)return 0;const n=v.value==="rtl"?d.value:p.value,l=v.value==="rtl"?p.value:d.value,u=o.offsetLeft,h=u+o.clientWidth,N=i.value.scrollLeft+n.clientWidth,q=i.value.scrollLeft+i.value.clientWidth-l.clientWidth;return u<N?u-N:h>q?h-q:0}function k(o){if(!i.value||!p.value||!d.value)return;const n=o==="next"&&v.value==="ltr"||o==="prev"&&v.value==="rtl"?1:-1;let l=0,u=o==="next"?i.value.firstElementChild:i.value.lastElementChild;for(;u;){const h=o==="next"?u.nextElementSibling:u.previousElementSibling;if(l=y(u),Math.sign(l)===n){h&&Math.abs(l)<.25*i.value.clientWidth&&(l=y(h));break}u=h}i.value.scrollBy({left:l,behavior:"smooth"}),_()}return e.watch(r,()=>{if(w.value===void 0||!i.value||!p.value||!d.value)return;const o=document.getElementById("".concat(w.value,"-label"));o&&i.value.scrollBy({left:y(o),behavior:"smooth"})}),{activeTab:r,activeTabIndex:T,activeTabId:w,currentDirection:v,rootElement:b,tabListElement:i,prevScroller:p,nextScroller:d,rootClasses:B,tabNames:m,tabsData:f,firstLabelVisible:S,lastLabelVisible:I,assignTemplateRefForTabButton:V,scrollTabs:k,focusActiveTab:_,cdxIconPrevious:x.n7,cdxIconNext:x.Y6}},methods:{select(t,s){const c=this.tabsData.get(t);c&&!(c!=null&&c.disabled)&&(this.activeTab=t,s&&e.nextTick(()=>{this.focusActiveTab()}))},selectNonDisabled(t,s,c){const b=this.tabsData.get(this.tabNames[t+s]);b&&(b.disabled?this.selectNonDisabled(t+s,s,c):this.select(b.name,c))},next(t){this.selectNonDisabled(this.activeTabIndex,1,t)},prev(t){this.selectNonDisabled(this.activeTabIndex,-1,t)},onLeftArrowKeypress(){this.currentDirection==="rtl"?this.next(!0):this.prev(!0)},onRightArrowKeypress(){this.currentDirection==="rtl"?this.prev(!0):this.next(!0)},onDownArrowKeypress(){var t;this.activeTabId&&((t=document.getElementById(this.activeTabId))==null||t.focus())}}});const P={class:"cdx-tabs__header"},j={ref:"prevScroller",class:"cdx-tabs__prev-scroller"},z={ref:"tabListElement",class:"cdx-tabs__list",role:"tablist"},G=["id","disabled","aria-controls","aria-selected","tabindex","onClick","onKeyup"],H={ref:"nextScroller",class:"cdx-tabs__next-scroller"},Y={class:"cdx-tabs__content"};function J(t,s,c,b,i,p){const d=e.resolveComponent("cdx-icon"),v=e.resolveComponent("cdx-button");return e.openBlock(),e.createElementBlock("div",{ref:"rootElement",class:e.normalizeClass(["cdx-tabs",t.rootClasses])},[e.createElementVNode("div",P,[e.withDirectives(e.createElementVNode("div",j,[e.createVNode(v,{class:"cdx-tabs__scroll-button",weight:"quiet",type:"button",tabindex:"-1","aria-hidden":!0,onMousedown:s[0]||(s[0]=e.withModifiers(()=>{},["prevent"])),onClick:s[1]||(s[1]=a=>t.scrollTabs("prev"))},{default:e.withCtx(()=>[e.createVNode(d,{icon:t.cdxIconPrevious},null,8,["icon"])]),_:1})],512),[[e.vShow,!t.firstLabelVisible]]),e.createElementVNode("div",z,[(e.openBlock(!0),e.createElementBlock(e.Fragment,null,e.renderList(t.tabsData.values(),(a,f)=>(e.openBlock(),e.createElementBlock("button",{id:"".concat(a.id,"-label"),key:f,ref_for:!0,ref:r=>t.assignTemplateRefForTabButton(r,f),disabled:a.disabled?!0:void 0,"aria-controls":a.id,"aria-selected":a.name===t.activeTab,tabindex:a.name===t.activeTab?void 0:-1,class:"cdx-tabs__list__item",role:"tab",onClick:e.withModifiers(r=>t.select(a.name),["prevent"]),onKeyup:e.withKeys(r=>t.select(a.name),["enter"]),onKeydown:[s[2]||(s[2]=e.withKeys(e.withModifiers((...r)=>t.onRightArrowKeypress&&t.onRightArrowKeypress(...r),["prevent"]),["right"])),s[3]||(s[3]=e.withKeys(e.withModifiers((...r)=>t.onDownArrowKeypress&&t.onDownArrowKeypress(...r),["prevent"]),["down"])),s[4]||(s[4]=e.withKeys(e.withModifiers((...r)=>t.onLeftArrowKeypress&&t.onLeftArrowKeypress(...r),["prevent"]),["left"]))]},[e.createElementVNode("span",null,e.toDisplayString(a.label),1)],40,G))),128))],512),e.withDirectives(e.createElementVNode("div",H,[e.createVNode(v,{class:"cdx-tabs__scroll-button",weight:"quiet",type:"button",tabindex:"-1","aria-hidden":!0,onMousedown:s[5]||(s[5]=e.withModifiers(()=>{},["prevent"])),onClick:s[6]||(s[6]=a=>t.scrollTabs("next"))},{default:e.withCtx(()=>[e.createVNode(d,{icon:t.cdxIconNext},null,8,["icon"])]),_:1})],512),[[e.vShow,!t.lastLabelVisible]])]),e.createElementVNode("div",Y,[e.createCommentVNode(" @slot One or more Tab components must be provided here "),e.renderSlot(t.$slots,"default")])],2)}const Q=O._export_sfc(F,[["render",J]]);module.exports=Q;
